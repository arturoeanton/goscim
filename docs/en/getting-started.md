# Getting Started with GoSCIM

Welcome to GoSCIM! This guide will get you up and running with your own SCIM 2.0 server in just a few minutes.

## What is GoSCIM?

GoSCIM is a lightweight, fast, and flexible implementation of the SCIM 2.0 protocol built in Go. It's designed to:

- 🚀 **Simplify identity management** across multiple systems
- 🔧 **Integrate easily** with existing infrastructure
- 📈 **Scale** from small startups to large enterprises
- 🛡️ **Secure** your identity data with industry best practices

## Quick Start (2 Minutes)

### Option 1: Docker (Recommended)

The fastest way to try GoSCIM:

```bash
# Clone the repository
git clone https://github.com/arturoeanton/goscim.git
cd goscim

# Start with Docker Compose
docker-compose up -d

# Wait for services to start (about 30 seconds)
sleep 30

# Test your SCIM server
curl http://localhost:8080/ServiceProviderConfig
```

### Option 2: Build from Source

If you prefer to build from source:

```bash
# Prerequisites: Go 1.16+ and Couchbase
git clone https://github.com/arturoeanton/goscim.git
cd goscim

# Set environment variables
export SCIM_ADMIN_USER="Administrator"
export SCIM_ADMIN_PASSWORD="admin123"

# Run the server
go run main.go
```

## Your First SCIM Operations

Once your server is running, try these basic operations:

### 1. Check Server Configuration
```bash
curl http://localhost:8080/ServiceProviderConfig
```

### 2. Create Your First User
```bash
curl -X POST http://localhost:8080/scim/v2/Users \
  -H "Content-Type: application/json" \
  -d '{
    "schemas": ["urn:ietf:params:scim:schemas:core:2.0:User"],
    "userName": "jane.doe@example.com",
    "name": {
      "familyName": "Doe",
      "givenName": "Jane"
    },
    "emails": [{
      "value": "jane.doe@example.com",
      "type": "work",
      "primary": true
    }],
    "active": true
  }'
```

### 3. Search for Users
```bash
curl "http://localhost:8080/scim/v2/Users?filter=userName sw 'jane'"
```

### 4. List Available Resources
```bash
curl http://localhost:8080/ResourceTypes
```

## Understanding the Response

When you create a user, you'll get a response like this:

```json
{
  "schemas": ["urn:ietf:params:scim:schemas:core:2.0:User"],
  "id": "550e8400-e29b-41d4-a716-446655440000",
  "userName": "jane.doe@example.com",
  "name": {
    "familyName": "Doe",
    "givenName": "Jane",
    "formatted": "Jane Doe"
  },
  "emails": [{
    "value": "jane.doe@example.com",
    "type": "work",
    "primary": true
  }],
  "active": true,
  "meta": {
    "resourceType": "User",
    "created": "2023-12-01T10:30:00Z",
    "lastModified": "2023-12-01T10:30:00Z",
    "version": "W/\"a330bc54f0671c9\"",
    "location": "/scim/v2/Users/550e8400-e29b-41d4-a716-446655440000"
  }
}
```

Key elements:
- **`id`**: Unique identifier generated by the server
- **`meta`**: Metadata including creation time and location
- **`schemas`**: SCIM schemas used for this resource

## Common Use Cases

### 1. Employee Onboarding
```bash
# Create new employee
curl -X POST http://localhost:8080/scim/v2/Users \
  -H "Content-Type: application/json" \
  -d '{
    "schemas": [
      "urn:ietf:params:scim:schemas:core:2.0:User",
      "urn:ietf:params:scim:schemas:extension:enterprise:2.0:User"
    ],
    "userName": "john.smith@company.com",
    "name": {
      "familyName": "Smith",
      "givenName": "John"
    },
    "emails": [{
      "value": "john.smith@company.com",
      "type": "work"
    }],
    "urn:ietf:params:scim:schemas:extension:enterprise:2.0:User": {
      "employeeNumber": "EMP001",
      "department": "Engineering",
      "manager": {
        "value": "manager-id-here"
      }
    }
  }'
```

### 2. Bulk User Import
```bash
# Import multiple users (when bulk operations are enabled)
curl -X POST http://localhost:8080/scim/v2/Bulk \
  -H "Content-Type: application/json" \
  -d '{
    "schemas": ["urn:ietf:params:scim:api:messages:2.0:BulkRequest"],
    "Operations": [
      {
        "method": "POST",
        "path": "/Users",
        "bulkId": "user1",
        "data": {
          "schemas": ["urn:ietf:params:scim:schemas:core:2.0:User"],
          "userName": "user1@example.com",
          "name": {"givenName": "User", "familyName": "One"}
        }
      },
      {
        "method": "POST",
        "path": "/Users", 
        "bulkId": "user2",
        "data": {
          "schemas": ["urn:ietf:params:scim:schemas:core:2.0:User"],
          "userName": "user2@example.com",
          "name": {"givenName": "User", "familyName": "Two"}
        }
      }
    ]
  }'
```

### 3. Advanced Filtering
```bash
# Find active users in engineering department
curl "http://localhost:8080/scim/v2/Users?filter=active eq true and urn:ietf:params:scim:schemas:extension:enterprise:2.0:User:department eq 'Engineering'"

# Find users with company email
curl "http://localhost:8080/scim/v2/Users?filter=emails[type eq 'work' and value ew '@company.com']"

# Find recently modified users
curl "http://localhost:8080/scim/v2/Users?filter=meta.lastModified gt '2023-01-01T00:00:00Z'"
```

## Working with Groups

### Create a Group
```bash
curl -X POST http://localhost:8080/scim/v2/Groups \
  -H "Content-Type: application/json" \
  -d '{
    "schemas": ["urn:ietf:params:scim:schemas:core:2.0:Group"],
    "displayName": "Engineering Team",
    "members": [
      {
        "value": "550e8400-e29b-41d4-a716-446655440000",
        "$ref": "/scim/v2/Users/550e8400-e29b-41d4-a716-446655440000",
        "type": "User",
        "display": "Jane Doe"
      }
    ]
  }'
```

### Add User to Group
```bash
curl -X PATCH http://localhost:8080/scim/v2/Groups/{group-id} \
  -H "Content-Type: application/json" \
  -d '{
    "schemas": ["urn:ietf:params:scim:api:messages:2.0:PatchOp"],
    "Operations": [{
      "op": "add",
      "path": "members",
      "value": [{
        "value": "{user-id}",
        "$ref": "/scim/v2/Users/{user-id}",
        "type": "User"
      }]
    }]
  }'
```

## Error Handling

GoSCIM returns standard HTTP status codes and SCIM error responses:

```json
{
  "schemas": ["urn:ietf:params:scim:api:messages:2.0:Error"],
  "detail": "Attribute 'userName' is required",
  "status": "400",
  "scimType": "invalidValue"
}
```

Common errors:
- **400 Bad Request**: Invalid data or missing required fields
- **404 Not Found**: Resource doesn't exist
- **409 Conflict**: Resource already exists (e.g., duplicate userName)
- **500 Internal Server Error**: Server-side issues

## Configuration Basics

### Environment Variables
```bash
# Database connection
export SCIM_ADMIN_USER="Administrator"
export SCIM_ADMIN_PASSWORD="your-secure-password"
export SCIM_COUCHBASE_URL="couchbase-server.example.com"

# Server settings
export SCIM_PORT=":8080"
export SCIM_LOG_LEVEL="info"

# Security (for production)
export SCIM_TLS_ENABLED="true"
export SCIM_TLS_CERT_FILE="/path/to/cert.pem"
export SCIM_TLS_KEY_FILE="/path/to/key.pem"
```

### Custom Schemas

You can add custom resource types by creating JSON files:

```bash
# Add a custom Device resource
cat > config/schemas/urn+example+com+schemas+Device.json << 'EOF'
{
  "id": "urn:example:com:schemas:Device",
  "name": "Device",
  "description": "Device resource for asset management",
  "attributes": [
    {
      "name": "deviceId",
      "type": "string",
      "required": true,
      "uniqueness": "server"
    },
    {
      "name": "deviceType",
      "type": "string",
      "canonicalValues": ["laptop", "phone", "tablet"]
    }
  ]
}
EOF

# Add corresponding resource type
cat > config/resourceType/Device.json << 'EOF'
{
  "schemas": ["urn:ietf:params:scim:schemas:core:2.0:ResourceType"],
  "id": "Device",
  "name": "Device", 
  "endpoint": "/Devices",
  "schema": "urn:example:com:schemas:Device"
}
EOF

# Restart server to load new schema
```

## Next Steps

Now that you have GoSCIM running, here are some next steps:

1. **🔐 [Set up authentication](security.md)** - Add OAuth 2.0 or JWT authentication
2. **📊 [Configure monitoring](operations.md)** - Set up metrics and logging
3. **🔌 [Add integrations](integrations.md)** - Connect to Active Directory, LDAP, or SaaS apps
4. **🏗️ [Learn the architecture](architecture.md)** - Understand how GoSCIM works internally
5. **👩‍💻 [Contribute](development.md)** - Help improve GoSCIM

## Getting Help

- 📚 **Documentation**: Check out the [full documentation](README.md)
- 🐛 **Issues**: Report bugs on [GitHub Issues](https://github.com/arturoeanton/goscim/issues)
- 💬 **Discussions**: Ask questions in [GitHub Discussions](https://github.com/arturoeanton/goscim/discussions)
- 📖 **Examples**: Explore the `httpexamples/` directory for more usage examples

## Example Integration Script

Here's a simple Python script to get you started with the SCIM API:

```python
import requests
import json

class GoSCIMClient:
    def __init__(self, base_url="http://localhost:8080"):
        self.base_url = base_url
        self.headers = {"Content-Type": "application/json"}
    
    def create_user(self, username, first_name, last_name, email):
        user_data = {
            "schemas": ["urn:ietf:params:scim:schemas:core:2.0:User"],
            "userName": username,
            "name": {
                "givenName": first_name,
                "familyName": last_name
            },
            "emails": [{
                "value": email,
                "type": "work",
                "primary": True
            }],
            "active": True
        }
        
        response = requests.post(
            f"{self.base_url}/scim/v2/Users",
            headers=self.headers,
            data=json.dumps(user_data)
        )
        return response.json()
    
    def search_users(self, filter_expr):
        response = requests.get(
            f"{self.base_url}/scim/v2/Users",
            params={"filter": filter_expr}
        )
        return response.json()

# Usage example
client = GoSCIMClient()

# Create a user
user = client.create_user(
    username="test@example.com",
    first_name="Test",
    last_name="User", 
    email="test@example.com"
)
print(f"Created user: {user['id']}")

# Search for users
results = client.search_users("userName sw 'test'")
print(f"Found {results['totalResults']} users")
```

Welcome to the GoSCIM community! 🎉